namespace = magica_mahou_shoujo_stress

# Magical girl death at maximum stress
magica_mahou_shoujo_stress.0001 = {
	type = character_event
	title = magica_mahou_shoujo_stress.0001.t
	desc = magica_mahou_shoujo_stress.0001.desc
	theme = mental_break

	left_portrait = {
		character = root
		animation = sad
	}

	option = {
		name = magica_mahou_shoujo_stress.0001.a
		death = {
			death_reason = death_stress
		}
	}
}

# 魔法少女年度压力检查事件
# 每年自动触发一次，检查魔法少女的压力状态
magica_mahou_shoujo_stress.0002 = {
	type = character_event
	hidden = yes
	
	trigger = {
		is_alive = yes
		has_trait = magica_mahou_shoujo
	}
	immediate = {
		# 根据囚禁状态调用对应的压力事件处理器
		add_stress = medium_stress_impact_gain
		if = {
			limit = { is_imprisoned = yes }
			trigger_event = { id = stress_threshold.0002 days = 0 }
		}
		else = {
			trigger_event = { id = stress_threshold.0001 days = 0 }
		}
		
		# 执行后续清理并调度下一年的检查
		magica_mahou_shoujo_stress_event_aftereffects = yes
	}
}
